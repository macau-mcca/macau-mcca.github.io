<!DOCTYPE html>
<html>
<head>
    <title>使用 JSONP 下载文件并设置 Header</title>
</head>
<body>
    <h1>欢迎访问</h1>

    <script>
        // 替换成你的 JSONP API URL
        const jsonpUrl = 'https://justmysocks5.net/members/getbwcounter.php?service=531532&id=0ffb1cda-1854-43ec-88c2-8d63cd32f280&callback=handleData';

        // 创建一个全局回调函数来处理 JSONP 数据
        function handleData(data) {
            // 处理从 JSONP 请求返回的数据
            const monthlyBwLimit = data.monthly_bw_limit_b;
            const bwCounter = data.bw_counter_b;
            const bwResetDayOfMonth = data.bw_reset_day_of_month;

            // 创建一个隐藏的链接元素
            const downloadLink = document.createElement('a');
            downloadLink.style.display = 'none';

            // 设置文件下载链接为本地文件路径
            downloadLink.href = 'mcca.yaml'; // 替换成你的本地文件路径

            // 设置文件的下载名称
            downloadLink.download = 'mcca.yaml';

            // 设置自定义头部信息
            downloadLink.setAttribute('data-monthly-bw-limit', monthlyBwLimit);
            downloadLink.setAttribute('data-bw-counter', bwCounter);
            downloadLink.setAttribute('data-bw-reset-day-of-month', bwResetDayOfMonth);

            // 将链接添加到页面中
            document.body.appendChild(downloadLink);

            // 模拟点击下载链接
            downloadLink.click();
        }

        // 创建一个动态的<script>标签来触发 JSONP 请求
        const script = document.createElement('script');
        script.src = jsonpUrl;

        // 将<script>标签添加到页面中触发 JSONP 请求
        document.body.appendChild(script);
    </script>
</body>
</html>
